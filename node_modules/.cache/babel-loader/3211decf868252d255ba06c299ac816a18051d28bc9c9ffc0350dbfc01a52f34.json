{"ast":null,"code":"import _slicedToArray from\"D:/Web/ReactJS/calculator/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useRef,useEffect,useState}from\"react\";import\"./calculator.css\";import{btns,BTN_ACTIONS}from\"./btnConfig\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Calculator=function Calculator(){var btnsRef=useRef(null);var expRef=useRef(null);var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),expression=_useState2[0],setExpression=_useState2[1];useEffect(function(){var btns=Array.from(btnsRef.current.querySelectorAll(\"button\"));btns.forEach(function(n){return n.style.height=n.offsetWidth+\"px\";});},[]);var btnClick=function btnClick(item){var expDiv=expRef.current;if(item.action===BTN_ACTIONS.THEME){document.body.classList.toggle(\"dark\");}if(item.action===BTN_ACTIONS.ADD){addAnimSpan(item.display);var oper=item.display!==\"x\"?item.display:\"*\";setExpression(expression+oper);}if(item.action===BTN_ACTIONS.DELETE){expDiv.parentNode.querySelector(\"div:last-child\").innerHTML=\"\";expDiv.innerHTML=\"\";setExpression(\"\");}if(item.action===BTN_ACTIONS.CALC){if(expression.trim().length<=0)return;expDiv.parentNode.querySelector(\"div:last-child\").remove();var cloneNode=expDiv.cloneNode(true);expDiv.parentNode.appendChild(cloneNode);var transform=\"translateY(\".concat(-(expDiv.offsetHeight+10)+\"px\",\") scale(0.4)\");try{var res=eval(expression);setExpression(res.toString());setTimeout(function(){cloneNode.style.transform=transform;expDiv.innerHTML=\"\";addAnimSpan(Math.floor(res*100000000)/100000000);},200);}catch(_unused){setTimeout(function(){cloneNode.style.transform=transform;expDiv.innerHTML=\"Syntax err\";},200);}finally{console.log(\"calc complete\");}}};var addAnimSpan=function addAnimSpan(content){var expDiv=expRef.current;var span=document.createElement(\"span\");span.innerHTML=content;span.style.opacity=\"0\";expDiv.appendChild(span);var width=span.offsetWidth+\"px\";span.style.width=\"0\";setTimeout(function(){span.style.opacity=\"1\";span.style.width=width;},100);};return/*#__PURE__*/_jsxs(\"div\",{className:\"calculator\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"calculator__result\",children:[/*#__PURE__*/_jsx(\"div\",{ref:expRef,className:\"calculator__result__exp\"}),/*#__PURE__*/_jsx(\"div\",{className:\"calculator__result__exp\"})]}),/*#__PURE__*/_jsx(\"div\",{ref:btnsRef,className:\"calculator__btns\",children:btns.map(function(item,index){return/*#__PURE__*/_jsx(\"button\",{className:item.class,onClick:function onClick(){return btnClick(item);},children:item.display},index);})})]});};export default Calculator;","map":{"version":3,"names":["React","useRef","useEffect","useState","btns","BTN_ACTIONS","Calculator","btnsRef","expRef","expression","setExpression","Array","from","current","querySelectorAll","forEach","n","style","height","offsetWidth","btnClick","item","expDiv","action","THEME","document","body","classList","toggle","ADD","addAnimSpan","display","oper","DELETE","parentNode","querySelector","innerHTML","CALC","trim","length","remove","cloneNode","appendChild","transform","offsetHeight","res","eval","toString","setTimeout","Math","floor","console","log","content","span","createElement","opacity","width","map","index","class"],"sources":["D:/Web/ReactJS/calculator/src/components/Calculator.jsx"],"sourcesContent":["import React, { useRef, useEffect, useState } from \"react\";\r\n\r\nimport \"./calculator.css\";\r\n\r\nimport { btns, BTN_ACTIONS } from \"./btnConfig\";\r\n\r\nconst Calculator = () => {\r\n  const btnsRef = useRef(null);\r\n  const expRef = useRef(null);\r\n\r\n  const [expression, setExpression] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    const btns = Array.from(btnsRef.current.querySelectorAll(\"button\"));\r\n\r\n    btns.forEach((n) => (n.style.height = n.offsetWidth + \"px\"));\r\n  }, []);\r\n\r\n  const btnClick = (item) => {\r\n    const expDiv = expRef.current;\r\n\r\n    if (item.action === BTN_ACTIONS.THEME) {\r\n      document.body.classList.toggle(\"dark\");\r\n    }\r\n\r\n    if (item.action === BTN_ACTIONS.ADD) {\r\n      addAnimSpan(item.display);\r\n\r\n      const oper = item.display !== \"x\" ? item.display : \"*\";\r\n      setExpression(expression + oper);\r\n    }\r\n\r\n    if (item.action === BTN_ACTIONS.DELETE) {\r\n      expDiv.parentNode.querySelector(\"div:last-child\").innerHTML = \"\";\r\n      expDiv.innerHTML = \"\";\r\n\r\n      setExpression(\"\");\r\n    }\r\n\r\n    if (item.action === BTN_ACTIONS.CALC) {\r\n      if (expression.trim().length <= 0) return;\r\n\r\n      expDiv.parentNode.querySelector(\"div:last-child\").remove();\r\n\r\n      const cloneNode = expDiv.cloneNode(true);\r\n      expDiv.parentNode.appendChild(cloneNode);\r\n\r\n      const transform = `translateY(${\r\n        -(expDiv.offsetHeight + 10) + \"px\"\r\n      }) scale(0.4)`;\r\n\r\n      try {\r\n        let res = eval(expression);\r\n\r\n        setExpression(res.toString());\r\n        setTimeout(() => {\r\n          cloneNode.style.transform = transform;\r\n          expDiv.innerHTML = \"\";\r\n          addAnimSpan(Math.floor(res * 100000000) / 100000000);\r\n        }, 200);\r\n      } catch {\r\n        setTimeout(() => {\r\n          cloneNode.style.transform = transform;\r\n          expDiv.innerHTML = \"Syntax err\";\r\n        }, 200);\r\n      } finally {\r\n        console.log(\"calc complete\");\r\n      }\r\n    }\r\n  };\r\n\r\n  const addAnimSpan = (content) => {\r\n    const expDiv = expRef.current;\r\n    const span = document.createElement(\"span\");\r\n\r\n    span.innerHTML = content;\r\n    span.style.opacity = \"0\";\r\n    expDiv.appendChild(span);\r\n\r\n    const width = span.offsetWidth + \"px\";\r\n    span.style.width = \"0\";\r\n\r\n    setTimeout(() => {\r\n      span.style.opacity = \"1\";\r\n      span.style.width = width;\r\n    }, 100);\r\n  };\r\n\r\n  return (\r\n    <div className=\"calculator\">\r\n      <div className=\"calculator__result\">\r\n        <div ref={expRef} className=\"calculator__result__exp\"></div>\r\n        <div className=\"calculator__result__exp\"></div>\r\n      </div>\r\n      <div ref={btnsRef} className=\"calculator__btns\">\r\n        {btns.map((item, index) => (\r\n          <button\r\n            key={index}\r\n            className={item.class}\r\n            onClick={() => btnClick(item)}\r\n          >\r\n            {item.display}\r\n          </button>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Calculator;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}